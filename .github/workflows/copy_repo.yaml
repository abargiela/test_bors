name: copy repo

on:
  push:

jobs:
  copy_repo:
    name: copy-repo
    runs-on: ubuntu-latest
    timeout-minutes: 70
    steps:
        - name: Checkout
          uses: actions/checkout@v2

        - run: mkdir -p artifact

        - run: echo hello > artifact/world.txt

        - uses: actions/upload-artifact@v2
          with:
            name: my-artifact
            path: artifact/world.txt

        - name: check folder
          run: ls -lahS artifact && cd artifact && pwd

        - name: copy files
          run: |
            git clone https://.:${{ secrets.BORS }}@github.com/abargiela/test_bors_ng_copy.git target
            rm -rf target/*
            cp -r .* target/ --exclude .git 
            git add target
            git commit -m "Automatic publish from github.com/prject"
            git push target master
